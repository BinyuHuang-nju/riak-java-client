<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QueryResult.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Riak Client for Java</a> &gt; <a href="index.source.html" class="el_package">com.basho.riak.client.core.query.timeseries</a> &gt; <span class="el_source">QueryResult.java</span></div><h1>QueryResult.java</h1><pre class="source lang-java linenums">package com.basho.riak.client.core.query.timeseries;

import com.basho.riak.protobuf.RiakTsPB;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;

/**
 * Holds a result set from a query, keylist, or fetch command.
 * Immutable once created.
 * @author Alex Moore &lt;amoore at basho dot com&gt;
 * @author Sergey Galkin &lt;srggal at gmail dot com&gt;
 * @since 2.0.3
 */
public class QueryResult implements Iterable&lt;Row&gt;
{
<span class="fc" id="L20">    public static final QueryResult EMPTY = new QueryResult();</span>
    private final Iterable&lt;RiakTsPB.TsRow&gt; pbRows;
    private final Row[] rows;
    private final int rowCount;
    private final List&lt;RiakTsPB.TsColumnDescription&gt; pbColumnDescriptions;

    private QueryResult()
<span class="fc" id="L27">    {</span>
<span class="fc" id="L28">        this.pbRows = Collections.emptyList();</span>
<span class="fc" id="L29">        this.rowCount = 0;</span>
<span class="fc" id="L30">        this.pbColumnDescriptions = Collections.emptyList();</span>
<span class="fc" id="L31">        this.rows = null;</span>
<span class="fc" id="L32">    }</span>

    public QueryResult(List&lt;RiakTsPB.TsRow&gt; tsRows)
    {
<span class="nc" id="L36">        this(Collections.&lt;RiakTsPB.TsColumnDescription&gt;emptyList(), tsRows);</span>
<span class="nc" id="L37">    }</span>

    public QueryResult(Iterable&lt;RiakTsPB.TsRow&gt; tsRowsIterator, int rowCount)
<span class="nc" id="L40">    {</span>
<span class="nc" id="L41">        this.pbColumnDescriptions = null;</span>
<span class="nc" id="L42">        this.pbRows = tsRowsIterator;</span>
<span class="nc" id="L43">        this.rowCount = rowCount;</span>
<span class="nc" id="L44">        this.rows = null;</span>
<span class="nc" id="L45">    }</span>

    public QueryResult(List&lt;RiakTsPB.TsColumnDescription&gt; columnsList, List&lt;RiakTsPB.TsRow&gt; rowsList)
<span class="fc" id="L48">    {</span>
<span class="fc" id="L49">        this.pbColumnDescriptions = columnsList;</span>
<span class="fc" id="L50">        this.pbRows = rowsList;</span>
<span class="fc" id="L51">        this.rowCount = rowsList.size();</span>
<span class="fc" id="L52">        this.rows = null;</span>
<span class="fc" id="L53">    }</span>

    public QueryResult(Row[] rows)
<span class="nc" id="L56">    {</span>
<span class="nc" id="L57">        this.rows = rows;</span>
<span class="nc" id="L58">        this.rowCount = rows.length;</span>
<span class="nc" id="L59">        this.pbRows = Collections.emptyList();</span>
<span class="nc" id="L60">        this.pbColumnDescriptions = Collections.emptyList();</span>
<span class="nc" id="L61">    }</span>

    /**
     * Provides a deep copy of the ColumnDescription List, if one was returned from the operation.
     * @return a deep copy of the ColumnDescriptions
     */
    public List&lt;ColumnDescription&gt; getColumnDescriptionsCopy()
    {
<span class="fc" id="L69">        return CollectionConverters.convertPBColumnDescriptions(this.pbColumnDescriptions);</span>
    }

    /**
     * An iterator of the Rows in this QueryResult.
     * @return an iterator.
     */
    public Iterator&lt;Row&gt; iterator()
    {
<span class="pc bpc" id="L78" title="1 of 2 branches missed.">        if (this.rows != null)</span>
        {
<span class="nc" id="L80">            return Arrays.asList(this.rows).iterator();</span>
        }
        else
        {
<span class="fc" id="L84">            return ConvertibleIteratorUtils.iterateAsRow(this.pbRows.iterator(), this.pbColumnDescriptions);</span>
        }
    }

    /**
     * Get the number of rows in this query result.
     * @return the count of rows in this query result.
     */
    public int getRowsCount()
    {
<span class="fc" id="L94">        return this.rowCount;</span>
    }

    /**
     * Get a shallow copy of the rows in this query result.
     * @return a List&amp;lt;Row&amp;gt; shallow copy of the rows in this query result.
     */
    public List&lt;Row&gt; getRowsCopy()
    {
<span class="fc" id="L103">        final List&lt;Row&gt; rows = new ArrayList&lt;&gt;(this.getRowsCount());</span>

<span class="fc bfc" id="L105" title="All 2 branches covered.">        for (Row cells : this)</span>
        {
<span class="fc" id="L107">            rows.add(cells);</span>
<span class="fc" id="L108">        }</span>

<span class="fc" id="L110">        return rows;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>